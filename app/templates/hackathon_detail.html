{% extends "base.html" %}

{% block title %}{{ hackathon.title }} — N.E.S.T{% endblock %}

{% block content %}
<div class="row g-4">

    <!-- Left column — details -->
    <div class="col-lg-8">
        <div class="card shadow border-0">
            <div class="card-body p-4">
                <div class="d-flex justify-content-between align-items-start mb-3">
                    <div>
                        <h3 class="card-title mb-1">{{ hackathon.title }}</h3>
                        {% if hackathon.organizer %}
                        <p class="text-secondary mb-0">
                            <i class="bi bi-building me-1"></i>{{ hackathon.organizer }}
                        </p>
                        {% endif %}
                    </div>
                    <span
                        class="badge fs-6 {% if hackathon.status.value == 'Upcoming' %}bg-info{% elif hackathon.status.value == 'Active' %}bg-success{% else %}bg-secondary{% endif %}">
                        {{ hackathon.status.value }}
                    </span>
                </div>

                {% if hackathon.description %}
                <p class="mb-3">{{ hackathon.description }}</p>
                {% endif %}

                <!-- Dates -->
                <div class="row g-3 mb-3">
                    {% if hackathon.start_date %}
                    <div class="col-md-4">
                        <small class="text-secondary d-block">Start Date</small>
                        <strong>{{ hackathon.start_date.strftime('%b %d, %Y %H:%M') }}</strong>
                    </div>
                    {% endif %}
                    {% if hackathon.end_date %}
                    <div class="col-md-4">
                        <small class="text-secondary d-block">End Date</small>
                        <strong>{{ hackathon.end_date.strftime('%b %d, %Y %H:%M') }}</strong>
                    </div>
                    {% endif %}
                    {% if hackathon.registration_deadline %}
                    <div class="col-md-4">
                        <small class="text-secondary d-block">Registration Deadline</small>
                        <strong class="text-warning">{{ hackathon.registration_deadline.strftime('%b %d, %Y %H:%M')
                            }}</strong>
                    </div>
                    {% endif %}
                </div>

                <!-- Team size -->
                <div class="mb-3">
                    <small class="text-secondary d-block">Team Size</small>
                    <strong>{{ hackathon.min_team_size or 1 }}–{{ hackathon.max_team_size or 5 }} members</strong>
                </div>

                <!-- Required capabilities -->
                {% if hackathon.required_capabilities %}
                <div class="mb-3">
                    <small class="text-secondary d-block mb-1">Required Capabilities</small>
                    <div class="d-flex flex-wrap gap-1">
                        {% for cap in hackathon.required_capabilities %}
                        <span class="badge bg-primary bg-opacity-25 text-primary-emphasis">{{ cap }}</span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}

                <!-- Tags -->
                {% if hackathon.tags %}
                <div class="mb-0">
                    <small class="text-secondary d-block mb-1">Tags</small>
                    <div class="d-flex flex-wrap gap-1">
                        {% for tag in hackathon.tags %}
                        <span class="badge bg-light text-dark border">#{{ tag }}</span>
                        {% endfor %}
                    </div>
                </div>
                {% endif %}
            </div>
        </div>
    </div>

    <!-- Right column — teams -->
    <div class="col-lg-4">
        <div class="card shadow border-0">
            <div class="card-header bg-transparent border-bottom-0 pt-4 px-4">
                <h5 class="mb-0"><i class="bi bi-people-fill me-2 text-primary"></i>Teams ({{ teams | length }})</h5>
            </div>
            <div class="card-body px-4 pb-4 pt-2">
                {% if teams %}
                {% for team in teams %}
                <div class="border rounded p-3 mb-2">
                    <strong>{{ team.name }}</strong>
                    {% if team.description %}
                    <p class="text-secondary small mb-0">{{ team.description[:80] }}</p>
                    {% endif %}
                </div>
                {% endfor %}
                {% else %}
                <p class="text-secondary mb-0">No teams yet.</p>
                {% endif %}

                {% if current_user and current_user.account_type.value == 'Leader' and hackathon.status.value !=
                'Completed' %}
                <a href="/teams/create?hackathon_id={{ hackathon.id }}" class="btn btn-primary btn-sm w-100 mt-3">
                    <i class="bi bi-plus-circle me-1"></i>Create Team
                </a>
                {% endif %}

                {% if current_user and hackathon.status.value != 'Completed' %}
                <a href="/match/teams-for-me/{{ hackathon.id }}"
                    class="btn btn-info btn-sm w-100 mt-3 fw-bold btn-glow">
                    <i class="bi bi-magic me-1"></i>Find Top Matches
                </a>
                {% endif %}
            </div>
        </div>

        <div class="mt-3">
            <a href="/hackathons/dashboard" class="btn btn-outline-secondary btn-sm w-100">
                <i class="bi bi-arrow-left me-1"></i>Back to Dashboard
            </a>
        </div>
    </div>

</div>
{% endblock %}